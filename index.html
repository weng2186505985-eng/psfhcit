<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#fef5f5">
    <title>PsycheFit - ä¾æ‹é£æ ¼æµ‹è¯•</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #fef5f5 0%, #f0e8f5 50%, #e8f0f5 100%);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        .bg-circle {
            position: fixed;
            border-radius: 50%;
            opacity: 0.15;
            pointer-events: none;
            z-index: 0;
            animation: float 20s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            25% { transform: translate(10px, -10px) scale(1.05); }
            50% { transform: translate(-10px, 10px) scale(0.95); }
            75% { transform: translate(10px, 10px) scale(1.02); }
        }

        .bg-circle-1 {
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, #ffc9d4, transparent);
            top: 10%;
            left: -100px;
        }

        .bg-circle-2 {
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, #c9d4ff, transparent);
            bottom: 10%;
            right: -150px;
            animation-delay: -10s;
        }

        .bg-circle-3 {
            width: 250px;
            height: 250px;
            background: radial-gradient(circle, #d4ffc9, transparent);
            top: 50%;
            right: -80px;
            animation-delay: -5s;
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 100%;
            min-height: 100vh;
            padding: 0;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            background: rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 100;
            transition: all 0.3s ease;
        }

        .header.scrolled {
            background: rgba(255, 255, 255, 0.8);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 20px;
            font-weight: 600;
            color: #2d3748;
        }

        .logo-icon {
            width: 36px;
            height: 36px;
            background: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .settings-icon {
            width: 36px;
            height: 36px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #718096;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .settings-icon:active {
            transform: scale(0.9);
        }

        .welcome-screen {
            text-align: center;
            padding: 60px 24px 40px;
            animation: fadeInUp 0.6s ease;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: white;
            padding: 10px 20px;
            border-radius: 20px;
            color: #718096;
            font-size: 14px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            animation: fadeInUp 0.6s ease 0.1s both;
        }

        .main-title {
            font-size: 36px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 10px;
            line-height: 1.2;
            animation: fadeInUp 0.6s ease 0.2s both;
        }

        .main-title .highlight {
            background: linear-gradient(135deg, #a8b5c8, #c8b5d8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 16px;
            color: #718096;
            line-height: 1.6;
            margin-bottom: 40px;
            padding: 0 20px;
            animation: fadeInUp 0.6s ease 0.3s both;
        }

        .start-button {
            background: linear-gradient(135deg, #8fa89f, #a8b89f);
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: 30px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(143, 168, 159, 0.3);
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            animation: fadeInUp 0.6s ease 0.4s both;
        }

        .start-button:active {
            transform: scale(0.98);
        }

        .time-info {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            color: #a0aec0;
            font-size: 14px;
            margin-top: 20px;
            animation: fadeInUp 0.6s ease 0.5s both;
        }

        .test-screen {
            display: none;
            height: calc(100vh - 68px);
            padding: 0;
            animation: fadeIn 0.4s ease;
            flex-direction: column;
        }

        .progress-section {
            padding: 20px 24px 16px;
            background: rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(10px);
        }

        .progress-bar-container {
            width: 100%;
            height: 4px;
            background: rgba(143, 168, 159, 0.15);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #8fa89f, #a8b89f);
            border-radius: 10px;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            width: 0;
            position: relative;
        }

        .progress-bar-fill::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 20px;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4));
            border-radius: 10px;
        }

        .question-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 0 24px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .question-container {
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
        }

        .question-title {
            font-size: 24px;
            font-weight: 600;
            color: #2d3748;
            line-height: 1.5;
            text-align: center;
            margin-bottom: 48px;
            animation: fadeIn 0.4s ease;
            padding: 0 10px;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 14px;
        }

        .option {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(143, 168, 159, 0.1);
            border-radius: 18px;
            padding: 18px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 15px;
            color: #2d3748;
            font-weight: 500;
            line-height: 1.5;
            animation: fadeIn 0.4s ease;
            animation-fill-mode: both;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        }

        .option:nth-child(1) { animation-delay: 0.1s; }
        .option:nth-child(2) { animation-delay: 0.15s; }
        .option:nth-child(3) { animation-delay: 0.2s; }
        .option:nth-child(4) { animation-delay: 0.25s; }

        .option:active {
            transform: scale(0.97);
            background: linear-gradient(135deg, rgba(168, 184, 159, 0.25), rgba(168, 184, 159, 0.15));
            border-color: #a8b89f;
            box-shadow: 0 4px 12px rgba(143, 168, 159, 0.2);
        }

        .test-footer {
            padding: 16px 24px 20px;
            background: rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(10px);
        }

        .back-button {
            width: 100%;
            padding: 14px;
            border-radius: 30px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            border: 2px solid rgba(143, 168, 159, 0.2);
            background: rgba(255, 255, 255, 0.8);
            color: #718096;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .back-button:active {
            transform: scale(0.98);
        }

        .back-button:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .reflection-screen {
            display: none;
            text-align: center;
            padding: 80px 24px 40px;
            animation: fadeIn 0.8s ease;
        }

        .reflection-icon {
            font-size: 120px;
            margin-bottom: 40px;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .reflection-title {
            font-size: 28px;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 20px;
        }

        .reflection-subtitle {
            font-size: 16px;
            color: #718096;
            line-height: 1.6;
            margin-bottom: 40px;
        }

        .analysis-progress {
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px 24px;
            margin-bottom: 30px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        .progress-label {
            color: #4a5568;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .progress-percentage {
            color: #8fa89f;
            font-size: 18px;
            font-weight: 700;
        }

        .progress-bar-container-loading {
            width: 100%;
            height: 12px;
            background: rgba(143, 168, 159, 0.15);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            margin-bottom: 20px;
        }

        .progress-bar-fill-loading {
            height: 100%;
            background: linear-gradient(90deg, #8fa89f, #a8b89f);
            border-radius: 10px;
            width: 0;
            transition: width 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .progress-bar-fill-loading::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-steps {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .progress-step {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 0;
            opacity: 0.4;
            transition: opacity 0.3s ease;
        }

        .progress-step.active { opacity: 1; }
        .progress-step.completed { opacity: 0.7; }

        .step-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: rgba(143, 168, 159, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            flex-shrink: 0;
        }

        .progress-step.active .step-icon {
            background: linear-gradient(135deg, #8fa89f, #a8b89f);
            color: white;
        }

        .progress-step.completed .step-icon {
            background: #8fa89f;
            color: white;
        }

        .step-text {
            font-size: 14px;
            color: #4a5568;
            text-align: left;
        }

        .result-screen {
            display: none;
            padding: 20px 24px 40px;
            animation: fadeIn 0.6s ease;
        }

        .result-opening {
            background: linear-gradient(135deg, rgba(143, 168, 159, 0.08), rgba(168, 184, 159, 0.08));
            border-radius: 24px;
            padding: 32px 24px;
            margin-bottom: 24px;
            text-align: center;
            animation: fadeInUp 0.6s ease;
        }

        .result-opening-icon {
            font-size: 48px;
            margin-bottom: 20px;
        }

        .result-opening-title {
            font-size: 22px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 16px;
            line-height: 1.4;
        }

        .result-opening-text {
            font-size: 16px;
            color: #4a5568;
            line-height: 1.8;
        }

        .attachment-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            padding: 30px 24px;
            margin-bottom: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.06);
            animation: fadeInUp 0.6s ease 0.1s both;
            position: relative;
            overflow: hidden;
        }

        .attachment-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #8fa89f, #a8b89f);
        }

        .attachment-badge {
            display: inline-block;
            padding: 6px 16px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-bottom: 16px;
        }

        .badge-healthy { background: rgba(143, 168, 159, 0.2); color: #5a7a6a; }
        .badge-anxious { background: rgba(255, 150, 120, 0.2); color: #cc6644; }
        .badge-avoidant { background: rgba(120, 150, 200, 0.2); color: #5577aa; }
        .badge-fearful { background: rgba(200, 150, 200, 0.2); color: #aa7799; }

        .attachment-name {
            font-size: 28px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 12px;
        }

        .attachment-subtitle {
            font-size: 14px;
            color: #718096;
            margin-bottom: 20px;
        }

        .score-visual {
            background: rgba(248, 250, 252, 0.8);
            border-radius: 16px;
            padding: 20px;
            margin: 20px 0;
        }

        .score-visual-title {
            font-size: 14px;
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 16px;
            text-align: center;
        }

        .score-item {
            margin-bottom: 14px;
        }

        .score-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
            font-size: 13px;
        }

        .score-name {
            color: #4a5568;
            font-weight: 500;
        }

        .score-value {
            color: #8fa89f;
            font-weight: 600;
        }

        .score-bar-bg {
            height: 6px;
            background: rgba(226, 232, 240, 0.5);
            border-radius: 10px;
            overflow: hidden;
        }

        .score-bar-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
            width: 0;
        }

        .score-bar-fill.secure { background: linear-gradient(90deg, #8fa89f, #a8b89f); }
        .score-bar-fill.anxious { background: linear-gradient(90deg, #ff9678, #ffb699); }
        .score-bar-fill.avoidant { background: linear-gradient(90deg, #7896c8, #98b6e8); }
        .score-bar-fill.fearful { background: linear-gradient(90deg, #c896c8, #d8b6d8); }

        .scenario-mirror {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 28px 24px;
            margin-bottom: 20px;
            animation: fadeInUp 0.6s ease 0.2s both;
        }

        .scenario-mirror-title {
            font-size: 18px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .scenario-item {
            background: linear-gradient(135deg, rgba(143, 168, 159, 0.05), rgba(168, 184, 159, 0.05));
            border-left: 3px solid #8fa89f;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 14px;
        }

        .scenario-item:last-child {
            margin-bottom: 0;
        }

        .scenario-situation {
            font-size: 14px;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 8px;
        }

        .scenario-response {
            font-size: 14px;
            color: #4a5568;
            line-height: 1.6;
        }

        .relationship-impact {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 28px 24px;
            margin-bottom: 20px;
            animation: fadeInUp 0.6s ease 0.3s both;
        }

        .relationship-impact-title {
            font-size: 18px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .relationship-impact-text {
            font-size: 15px;
            color: #4a5568;
            line-height: 1.8;
            margin-bottom: 20px;
        }

        .partner-tips {
            background: linear-gradient(135deg, rgba(168, 181, 216, 0.08), rgba(200, 181, 216, 0.08));
            border-radius: 12px;
            padding: 16px;
        }

        .partner-tips-label {
            font-size: 13px;
            font-weight: 600;
            color: #5a6a7a;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .partner-tips-text {
            font-size: 14px;
            color: #4a5568;
            line-height: 1.6;
        }

        .action-plan {
            background: linear-gradient(135deg, rgba(143, 168, 159, 0.12), rgba(168, 184, 159, 0.08));
            border-radius: 20px;
            padding: 28px 24px;
            margin-bottom: 20px;
            animation: fadeInUp 0.6s ease 0.4s both;
        }

        .action-plan-title {
            font-size: 18px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .action-plan-subtitle {
            font-size: 14px;
            color: #5a7a6a;
            margin-bottom: 20px;
            font-weight: 500;
        }

        .action-item {
            background: white;
            border-radius: 14px;
            padding: 18px;
            margin-bottom: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            position: relative;
            padding-left: 54px;
        }

        .action-item:last-child {
            margin-bottom: 0;
        }

        .action-number {
            position: absolute;
            left: 18px;
            top: 18px;
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, #8fa89f, #a8b89f);
            border-radius: 50%;
            color: white;
            font-size: 13px;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .action-title {
            font-size: 15px;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 8px;
        }

        .action-desc {
            font-size: 14px;
            color: #4a5568;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .action-how {
            font-size: 13px;
            color: #718096;
            background: rgba(143, 168, 159, 0.08);
            padding: 10px 12px;
            border-radius: 8px;
            line-height: 1.5;
        }

        .action-how strong {
            color: #5a7a6a;
            font-weight: 600;
        }

        .today-action {
            background: linear-gradient(135deg, rgba(255, 240, 245, 0.9), rgba(245, 240, 255, 0.9));
            border-radius: 20px;
            padding: 28px 24px;
            margin-bottom: 20px;
            text-align: center;
            animation: fadeInUp 0.6s ease 0.5s both;
        }

        .today-action-icon {
            font-size: 40px;
            margin-bottom: 16px;
        }

        .today-action-title {
            font-size: 18px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 12px;
        }

        .today-action-text {
            font-size: 15px;
            color: #4a5568;
            line-height: 1.7;
            margin-bottom: 20px;
        }

        .today-action-button {
            background: linear-gradient(135deg, #8fa89f, #a8b89f);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 24px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(143, 168, 159, 0.3);
            transition: all 0.3s ease;
        }

        .today-action-button:active {
            transform: scale(0.98);
        }

        .resources-section {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 20px;
            animation: fadeInUp 0.6s ease 0.6s both;
        }

        .resources-title {
            font-size: 16px;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .resource-item {
            background: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .resource-item:active {
            transform: scale(0.98);
            border-color: #a8b89f;
        }

        .resource-name {
            font-size: 15px;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 5px;
        }

        .resource-desc {
            font-size: 13px;
            color: #718096;
            line-height: 1.5;
        }

        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }

        .share-button, .restart-button {
            flex: 1;
            padding: 16px 24px;
            border-radius: 30px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.3s ease;
        }

        .share-button {
            background: linear-gradient(135deg, #8fa89f, #a8b89f);
            color: white;
            box-shadow: 0 4px 15px rgba(143, 168, 159, 0.3);
        }

        .restart-button {
            background: white;
            color: #718096;
            border: 2px solid #e2e8f0;
        }

        .share-button:active, .restart-button:active {
            transform: scale(0.98);
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1001;
            padding: 20px;
        }

        .modal-content {
            background: white;
            border-radius: 24px;
            padding: 30px 24px;
            max-width: 400px;
            width: 100%;
        }

        .modal-title {
            font-size: 22px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 15px;
        }

        .modal-desc {
            font-size: 15px;
            color: #4a5568;
            line-height: 1.7;
            margin-bottom: 25px;
        }

        .modal-buttons {
            display: flex;
            gap: 12px;
        }

        .modal-button {
            flex: 1;
            padding: 14px;
            border-radius: 20px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.3s ease;
        }

        .modal-button-primary {
            background: linear-gradient(135deg, #8fa89f, #a8b89f);
            color: white;
        }

        .modal-button-secondary {
            background: rgba(226, 232, 240, 0.5);
            color: #4a5568;
        }

        .modal-button:active {
            transform: scale(0.95);
        }

        .toast {
            position: fixed;
            bottom: -100px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(45, 55, 72, 0.95);
            color: white;
            padding: 16px 24px;
            border-radius: 12px;
            z-index: 1002;
            transition: bottom 0.4s;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 15px;
        }

        .toast.show {
            bottom: 30px;
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            animation: confetti-fall 3s linear forwards;
            z-index: 999;
        }

        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        @media (max-width: 375px) {
            .main-title { font-size: 32px; }
            .question-title { font-size: 22px; }
        }

        @media (min-width: 768px) {
            .container { max-width: 600px; margin: 0 auto; }
        }
    </style>
</head>
<body>
    <div class="bg-circle bg-circle-1"></div>
    <div class="bg-circle bg-circle-2"></div>
    <div class="bg-circle bg-circle-3"></div>

    <div class="container">
        <div class="header" id="header">
            <div class="logo">
                <div class="logo-icon">ğŸŒ±</div>
                <span>PsycheFit</span>
            </div>
            <div class="settings-icon" onclick="showSettings()">âš™ï¸</div>
        </div>

        <div class="welcome-screen" id="welcomeScreen">
            <div class="badge">
                <span>ğŸ’š</span>
                <span>10ä¸‡+ æ­£åœ¨å¯»æ‰¾å†…å¿ƒå¹³é™</span>
            </div>
            <h1 class="main-title">
                å‘ç°ä½ çš„<br>
                <span class="highlight">å†…åœ¨è¿æ¥</span>
            </h1>
            <p class="subtitle">
                æ¸©å’Œåœ°äº†è§£ä½ çš„ä¾æ‹é£æ ¼ã€‚æ²»æ„ˆå…³ç³»çš„é“è·¯ä»å†…å¿ƒå¼€å§‹ã€‚
            </p>
            <button class="start-button" onclick="startTest()">
                å¼€å§‹æ—…ç¨‹
                <span>â†’</span>
            </button>
            <div class="time-info">
                <span>ğŸ•</span>
                <span>å¹³é™çš„6åˆ†é’Ÿ</span>
            </div>
        </div>

        <div class="test-screen" id="testScreen">
            <div class="progress-section">
                <div class="progress-bar-container">
                    <div class="progress-bar-fill" id="progressFill"></div>
                </div>
            </div>
            <div class="question-area">
                <div class="question-container">
                    <h2 class="question-title" id="questionTitle"></h2>
                    <div class="options" id="optionsContainer"></div>
                </div>
            </div>
            <div class="test-footer">
                <button class="back-button" id="backButton" onclick="previousQuestion()">
                    <span>â†</span>
                    <span>è¿”å›ä¸Šä¸€é¢˜</span>
                </button>
            </div>
        </div>

        <div class="reflection-screen" id="reflectionScreen">
            <div class="reflection-icon">ğŸŒ¸</div>
            <h2 class="reflection-title">æ­£åœ¨åˆ†æä½ çš„ä¾æ‹æ¨¡å¼...</h2>
            <p class="reflection-subtitle">è¯·ç¨ç­‰ç‰‡åˆ»ï¼Œæˆ‘ä»¬æ­£åœ¨ä¸ºä½ ç”Ÿæˆä¸“å±æŠ¥å‘Š</p>
            
            <div class="analysis-progress">
                <div class="progress-label">
                    <span>åˆ†æè¿›åº¦</span>
                    <span class="progress-percentage" id="progressPercentage">0%</span>
                </div>
                <div class="progress-bar-container-loading">
                    <div class="progress-bar-fill-loading" id="loadingProgressBar"></div>
                </div>
                
                <div class="progress-steps">
                    <div class="progress-step" id="step1">
                        <div class="step-icon">1</div>
                        <div class="step-text">æ”¶é›†å›ç­”æ•°æ®</div>
                    </div>
                    <div class="progress-step" id="step2">
                        <div class="step-icon">2</div>
                        <div class="step-text">åˆ†æä¾æ‹æ¨¡å¼</div>
                    </div>
                    <div class="progress-step" id="step3">
                        <div class="step-icon">3</div>
                        <div class="step-text">ç”Ÿæˆä¸ªæ€§åŒ–æ´å¯Ÿ</div>
                    </div>
                    <div class="progress-step" id="step4">
                        <div class="step-icon">4</div>
                        <div class="step-text">å‡†å¤‡æˆé•¿å»ºè®®</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="result-screen" id="resultScreen">
            <div id="resultContent"></div>
            <div class="action-buttons">
                <button class="share-button" onclick="shareResult()">ğŸ“Š åˆ†äº«ç»“æœ</button>
                <button class="restart-button" onclick="restartTest()">ğŸ”„ é‡æ–°æµ‹è¯•</button>
            </div>
        </div>
    </div>

    <div class="modal" id="modal">
        <div class="modal-content">
            <h3 class="modal-title" id="modalTitle"></h3>
            <p class="modal-desc" id="modalDesc"></p>
            <div class="modal-buttons">
                <button class="modal-button modal-button-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                <button class="modal-button modal-button-primary" id="modalConfirm">ç¡®è®¤</button>
            </div>
        </div>
    </div>

    <div class="toast" id="toast">
        <span class="toast-icon" id="toastIcon">âœ“</span>
        <span id="toastMessage">è¿›åº¦å·²ä¿å­˜</span>
    </div>

    <script>
        const questions = [
            { title: "ä½ æ”¶å…»äº†ä¸€åªå°çŒ«ï¼Œç¬¬ä¸€æ™šå®ƒèº²åœ¨æ²™å‘ä¸‹ä¸è‚¯å‡ºæ¥", options: [
                { text: "ç»™å®ƒæ—¶é—´ï¼Œå®ƒå‡†å¤‡å¥½äº†è‡ªç„¶ä¼šå‡ºæ¥", scores: { secure: 3, anxious: 0, avoidant: 2, fearful: 0 }},
                { text: "æ¯éš”ä¸€ä¼šå„¿å°±å»çœ‹çœ‹ï¼Œè¯•ç€å“„å®ƒå‡ºæ¥", scores: { secure: 1, anxious: 3, avoidant: 0, fearful: 1 }},
                { text: "æ”¾ä¸€äº›é£Ÿç‰©åœ¨é™„è¿‘ï¼Œç„¶ååšè‡ªå·±çš„äº‹", scores: { secure: 2, anxious: 0, avoidant: 3, fearful: 0 }},
                { text: "æ‹…å¿ƒå®ƒæ˜¯ä¸æ˜¯ä¸å–œæ¬¢è¿™é‡Œï¼Œä¹Ÿæ‹…å¿ƒå¼ºè¡Œæ¥è¿‘ä¼šå“åˆ°å®ƒ", scores: { secure: 0, anxious: 2, avoidant: 1, fearful: 3 }}
            ]},
            { title: "ä½ å…»çš„æ¤ç‰©å¼€å§‹æ¯è", options: [
                { text: "æŸ¥æ‰¾åŸå› ï¼Œè°ƒæ•´æµ‡æ°´å’Œå…‰ç…§", scores: { secure: 3, anxious: 1, avoidant: 1, fearful: 0 }},
                { text: "å¾ˆè‡ªè´£ï¼Œè§‰å¾—è‡ªå·±ç…§é¡¾ä¸å¥½ä»»ä½•ä¸œè¥¿", scores: { secure: 0, anxious: 3, avoidant: 0, fearful: 2 }},
                { text: "ç®—äº†ï¼Œåæ­£æ¤ç‰©ä¹Ÿä¸æ˜¯ä¸€å®šè¦å…»", scores: { secure: 1, anxious: 0, avoidant: 3, fearful: 1 }},
                { text: "æ—¢æƒ³æ•‘æ´»å®ƒåˆè§‰å¾—å¯èƒ½å·²ç»æ™šäº†", scores: { secure: 0, anxious: 2, avoidant: 1, fearful: 3 }}
            ]},
            { title: "åœ¨ç«è½¦ä¸Šï¼Œé‚»åº§çš„é™Œç”Ÿäººä¸»åŠ¨å’Œä½ èŠå¤©", options: [
                { text: "å‹å¥½åœ°èŠå‡ å¥ï¼Œçœ‹è¯é¢˜æ˜¯å¦æŠ•æœº", scores: { secure: 3, anxious: 2, avoidant: 0, fearful: 0 }},
                { text: "å¾ˆé«˜å…´æœ‰äººæ„¿æ„å’Œæˆ‘è¯´è¯", scores: { secure: 1, anxious: 3, avoidant: 0, fearful: 1 }},
                { text: "ç¤¼è²Œå›åº”ä½†ä¸å¤ªæƒ³æ·±èŠ", scores: { secure: 2, anxious: 0, avoidant: 3, fearful: 1 }},
                { text: "ä¸ç¡®å®šå¯¹æ–¹çš„æ„å›¾ï¼Œæ—¢æƒ³èŠåˆæœ‰äº›è­¦æƒ•", scores: { secure: 0, anxious: 1, avoidant: 1, fearful: 3 }}
            ]},
            { title: "ä½ çš„æ‰‹æœºçªç„¶æ²¡ç”µäº†ï¼Œå®Œå…¨è”ç³»ä¸åˆ°ä»»ä½•äºº", options: [
                { text: "æ²¡ä»€ä¹ˆå¤§ä¸äº†çš„ï¼Œæ‰¾åœ°æ–¹å……ç”µå°±å¥½", scores: { secure: 3, anxious: 0, avoidant: 2, fearful: 0 }},
                { text: "æœ‰ç‚¹ç„¦è™‘ï¼Œæ‹…å¿ƒé”™è¿‡é‡è¦æ¶ˆæ¯", scores: { secure: 1, anxious: 3, avoidant: 0, fearful: 2 }},
                { text: "åè€Œè§‰å¾—æŒºè‡ªåœ¨çš„", scores: { secure: 2, anxious: 0, avoidant: 3, fearful: 0 }},
                { text: "ä¸€æ–¹é¢æ…Œå¼ ä¸€æ–¹é¢åˆè§‰å¾—è¿™æ ·ä¹ŸæŒºå¥½", scores: { secure: 0, anxious: 2, avoidant: 1, fearful: 3 }}
            ]},
            { title: "æœ‹å‹é€äº†ä½ ä¸€ç›†éœ€è¦æ¯å¤©ç…§æ–™çš„ç»¿æ¤", options: [
                { text: "äº†è§£å®ƒçš„ä¹ æ€§ï¼Œå°½åŠ›ç…§é¡¾å¥½", scores: { secure: 3, anxious: 2, avoidant: 0, fearful: 0 }},
                { text: "å¾ˆæ‹…å¿ƒè‡ªå·±å…»ä¸å¥½è¾œè´Ÿæœ‹å‹çš„å¿ƒæ„", scores: { secure: 1, anxious: 3, avoidant: 0, fearful: 2 }},
                { text: "è¿™ä¸ªè´£ä»»æœ‰ç‚¹é‡ï¼Œå¯èƒ½ä¼šè€ƒè™‘é€ç»™åˆ«äºº", scores: { secure: 0, anxious: 0, avoidant: 3, fearful: 1 }},
                { text: "æƒ³è¦å¥½å¥½å…»ä½†åˆæ€•è¢«æŸç¼š", scores: { secure: 0, anxious: 2, avoidant: 2, fearful: 3 }}
            ]},
            { title: "ä½ å‘ç°æœ€å–œæ¬¢çš„å’–å•¡é¦†çªç„¶å…³é—¨äº†", options: [
                { text: "æœ‰ç‚¹é—æ†¾ï¼Œä½†å¯ä»¥æ‰¾æ–°çš„å»å¤„", scores: { secure: 3, anxious: 1, avoidant: 2, fearful: 0 }},
                { text: "å¾ˆå¤±è½ï¼Œè¿™é‡Œæœ‰å¾ˆå¤šå›å¿†", scores: { secure: 1, anxious: 3, avoidant: 0, fearful: 2 }},
                { text: "æ— æ‰€è°“ï¼Œæœ¬æ¥ä¹Ÿä¸æ˜¯éå»ä¸å¯", scores: { secure: 1, anxious: 0, avoidant: 3, fearful: 0 }},
                { text: "éš¾è¿‡ä½†å‘Šè¯‰è‡ªå·±åæ­£ä¹Ÿä¸è¯¥å¤ªä¾èµ–ä¸€ä¸ªåœ°æ–¹", scores: { secure: 0, anxious: 1, avoidant: 2, fearful: 3 }}
            ]},
            { title: "ä½ å‚åŠ äº†ä¸€ä¸ªworkshopï¼Œç»„ç»‡è€…è®©å¤§å®¶ä¸¤ä¸¤ç»„é˜Ÿ", options: [
                { text: "çœ‹çœ‹å‘¨å›´è°è¿˜æ²¡æœ‰æ­æ¡£ï¼Œä¸»åŠ¨è¯¢é—®", scores: { secure: 3, anxious: 1, avoidant: 1, fearful: 0 }},
                { text: "å¸Œæœ›æœ‰äººæ¥æ‰¾æˆ‘ç»„é˜Ÿ", scores: { secure: 1, anxious: 3, avoidant: 0, fearful: 2 }},
                { text: "å¦‚æœå¯ä»¥çš„è¯æ›´æƒ³ä¸€ä¸ªäººå®Œæˆ", scores: { secure: 1, anxious: 0, avoidant: 3, fearful: 1 }},
                { text: "æƒ³æ‰¾äººç»„é˜Ÿä½†åˆä¸æ•¢ä¸»åŠ¨", scores: { secure: 0, anxious: 2, avoidant: 1, fearful: 3 }}
            ]},
            { title: "ä¸€ä¸ªå¾ˆä¹…ä¸è”ç³»çš„è€æœ‹å‹å‘æ¥é—®å€™", options: [
                { text: "å¾ˆé«˜å…´ï¼Œè‡ªç„¶åœ°å›å¤èŠå‡ å¥", scores: { secure: 3, anxious: 2, avoidant: 1, fearful: 0 }},
                { text: "å¾ˆæ¿€åŠ¨ï¼Œç»ˆäºæƒ³èµ·æˆ‘äº†", scores: { secure: 1, anxious: 3, avoidant: 0, fearful: 1 }},
                { text: "å®¢æ°”å›å¤ä½†ä¸ä¼šæ·±èŠ", scores: { secure: 2, anxious: 0, avoidant: 3, fearful: 1 }},
                { text: "ä¸ç¡®å®šå¯¹æ–¹æ˜¯ä¸æ˜¯æœ‰äº‹æ‰æ‰¾æˆ‘", scores: { secure: 0, anxious: 2, avoidant: 1, fearful: 3 }}
            ]},
            { title: "ä½ é¢„å®šçš„é…’åº—æˆ¿é—´è¢«ä¸´æ—¶å–æ¶ˆäº†", options: [
                { text: "è”ç³»é…’åº—çœ‹èƒ½å¦è§£å†³ï¼Œæˆ–æ‰¾å…¶ä»–ä½å¤„", scores: { secure: 3, anxious: 1, avoidant: 2, fearful: 0 }},
                { text: "å¾ˆç„¦è™‘ï¼Œæ‹…å¿ƒæ‰¾ä¸åˆ°åˆé€‚çš„æ›¿ä»£æ–¹æ¡ˆ", scores: { secure: 1, anxious: 3, avoidant: 0, fearful: 2 }},
                { text: "ç®—äº†ï¼Œå¤§ä¸äº†æ¢ä¸ªåœ°æ–¹æˆ–è€…æ”¹è¡Œç¨‹", scores: { secure: 2, anxious: 0, avoidant: 3, fearful: 0 }},
                { text: "æ…Œä¹±åœ°å¼€å§‹æ‰¾å¤‡é€‰ï¼Œä½†åˆæ€•éƒ½ä¸æ»¡æ„", scores: { secure: 0, anxious: 2, avoidant: 0, fearful: 3 }}
            ]},
            { title: "ä½ åœ¨æ—…é€”ä¸­é‡åˆ°ä¸€ä¸ªæœ‰è¶£çš„æ—…ä¼´", options: [
                { text: "äº«å—ç›¸é‡çš„ç¼˜åˆ†ï¼Œçœ‹çœ‹èƒ½å¦ç»“ä¼´åŒè¡Œ", scores: { secure: 3, anxious: 2, avoidant: 0, fearful: 0 }},
                { text: "å¸Œæœ›èƒ½å¤šç›¸å¤„ä¸€æ®µæ—¶é—´", scores: { secure: 2, anxious: 3, avoidant: 0, fearful: 1 }},
                { text: "èŠå¾—æ¥å°±èŠï¼Œä½†ä¿æŒå„èµ°å„çš„", scores: { secure: 2, anxious: 0, avoidant: 3, fearful: 0 }},
                { text: "æƒ³è¦äº²è¿‘ä½†åˆæ‹…å¿ƒè¿‡äºä¾èµ–", scores: { secure: 0, anxious: 2, avoidant: 1, fearful: 3 }}
            ]}
        ];

        const attachmentDetails = {
            secure: {
                badge: 'badge-healthy',
                badgeText: "å¥åº·",
                name: "å®‰å…¨å‹ä¾æ‹",
                subtitle: "åœ¨å…³ç³»ä¸­æ„Ÿåˆ°è‡ªåœ¨å’Œå¹³è¡¡",
                opening: "æˆ‘ä»¬çœ‹åˆ°ï¼Œä½ åœ¨å…³ç³»ä¸­æ‹¥æœ‰ä¸€ç§çè´µçš„å¹³è¡¡â€”â€”æ—¢èƒ½äº²è¿‘ï¼Œä¹Ÿèƒ½ç‹¬å¤„ï¼›æ—¢ç›¸ä¿¡ä»–äººï¼Œä¹Ÿä¿¡ä»»è‡ªå·±ã€‚è¿™ä¸æ˜¯ä¸ç”Ÿä¿±æ¥çš„å¹¸è¿ï¼Œè€Œæ˜¯ä½ åœ¨æˆé•¿ä¸­å»ºç«‹çš„åŠ›é‡ã€‚",
                scenarios: [
                    { situation: "å½“ä¼´ä¾£éœ€è¦ç‹¬å¤„æ—¶", response: "ä½ ä¼šç»™äºˆç©ºé—´ï¼Œä¸ä¼šè¿‡åº¦è§£è¯»ä¸ºæ’æ–¥ï¼Œå› ä¸ºä½ ç†è§£ç‹¬å¤„çš„ä»·å€¼" },
                    { situation: "é‡åˆ°åˆ†æ­§æ—¶", response: "ä½ èƒ½å¤Ÿå¦è¯šè¡¨è¾¾æƒ³æ³•ï¼ŒåŒæ—¶å€¾å¬å¯¹æ–¹ï¼ŒæŠŠå†²çªè§†ä¸ºåŠ æ·±ç†è§£çš„æœºä¼š" },
                    { situation: "å¯¹æ–¹æ™šå›ä¿¡æ¯", response: "ä½ çš„ç¬¬ä¸€ååº”æ˜¯'ä»–å¯èƒ½å¾ˆå¿™'ï¼Œè€Œä¸æ˜¯'ä»–ä¸åœ¨ä¹æˆ‘äº†'" }
                ],
                relationshipImpact: "ä½ çš„å®‰å…¨æ„Ÿå°±åƒä¸€ä¸ªç¨³å®šçš„é”šç‚¹ï¼Œèƒ½è®©å…³ç³»ä¸­çš„å¦ä¸€æ–¹ä¹Ÿæ„Ÿåˆ°æ”¾æ¾ã€‚ä½ ä¸ä¼šç”¨æ§åˆ¶æ¥æ©é¥°ä¸å®‰ï¼Œä¹Ÿä¸ä¼šç”¨å†·æ¼ æ¥ä¿æŠ¤è‡ªå·±ã€‚è¿™ç§è‡ªåœ¨çš„çŠ¶æ€ï¼Œå¾€å¾€èƒ½å”¤èµ·ä»–äººå†…å¿ƒæ·±å¤„å¯¹è¿æ¥çš„æ¸´æœ›ã€‚",
                partnerTips: "å¯¹äºä¸å¤Ÿå®‰å…¨çš„ä¼´ä¾£ï¼šä½ çš„ç¨³å®šæ€§å¯ä»¥æˆä¸ºä»–ä»¬çš„ç–—æ„ˆç©ºé—´ã€‚ä¿æŒä¸€è‡´æ€§ï¼Œæ¸©å’Œè€Œåšå®šåœ°è¡¨è¾¾éœ€æ±‚ï¼Œç»™ä»–ä»¬å»ºç«‹ä¿¡ä»»çš„æ—¶é—´ã€‚",
                actions: [
                    { title: "ç»´æŠ¤ä½ çš„å®‰å…¨åŸºç¡€", desc: "å®‰å…¨ä¾æ‹ä¸æ˜¯ä¸€åŠ³æ°¸é€¸çš„ã€‚åœ¨å‹åŠ›ã€å˜åŒ–æˆ–åˆ›ä¼¤äº‹ä»¶åï¼Œä½ ä¹Ÿå¯èƒ½æš‚æ—¶å›åˆ°ä¸å®‰å…¨æ¨¡å¼ã€‚", how: "æ¯å‘¨èŠ±10åˆ†é’Ÿè§‰å¯Ÿï¼šæˆ‘æœ€è¿‘åœ¨å…³ç³»ä¸­æ˜¯å¦ä»ç„¶æ„Ÿåˆ°è‡ªåœ¨ï¼Ÿæ˜¯å¦æœ‰æ–°çš„é˜²å¾¡æœºåˆ¶åœ¨æ‚„æ‚„å½¢æˆï¼Ÿ" },
                    { title: "æˆä¸ºä»–äººçš„å®‰å…¨æ¸¯", desc: "ä½ çš„ç¨³å®šæ€§æ˜¯ä¸€ä»½ç¤¼ç‰©ï¼Œä½†ä¸è¦è®©å®ƒæˆä¸ºä½ çš„å…¨éƒ¨èº«ä»½ã€‚", how: "å½“åˆ«äººå‘ä½ å¯»æ±‚æƒ…æ„Ÿæ”¯æŒæ—¶ï¼Œåœ¨æä¾›å®‰æ…°çš„åŒæ—¶ï¼Œä¹Ÿé¼“åŠ±ä»–ä»¬å‘å±•è‡ªå·±çš„å®‰å…¨æ„Ÿã€‚ä¸è¦æˆä¸ºä»–ä»¬å”¯ä¸€çš„ä¾é ã€‚" },
                    { title: "æ·±åŒ–è‡ªæˆ‘è®¤çŸ¥", desc: "å®‰å…¨ä¾æ‹è€…æœ‰æ—¶ä¼šå¿½è§†è‡ªå·±çš„éœ€æ±‚ï¼Œå› ä¸º'æ²¡æœ‰é—®é¢˜'ã€‚", how: "å°è¯•æ¯å¤©å†™ä¸‹ï¼šä»Šå¤©æˆ‘åœ¨å…³ç³»ä¸­æ„Ÿå—åˆ°äº†ä»€ä¹ˆï¼Ÿæœ‰å“ªäº›éœ€æ±‚æ²¡æœ‰è¢«è¡¨è¾¾ï¼Ÿ" }
                ],
                todayAction: "ä»Šå¤©ï¼Œæ‰¾ä¸€ä¸ªä½ ä¿¡ä»»çš„äººï¼Œç”¨äº”åˆ†é’Ÿåˆ†äº«ä¸€ä»¶è®©ä½ è„†å¼±çš„äº‹â€”â€”ä¸æ˜¯ä¸ºäº†å¯»æ±‚å»ºè®®ï¼Œåªæ˜¯ä¸ºäº†è¢«çœ‹è§ã€‚è¿™ä¼šæé†’ä½ ï¼Œä½ çš„å®‰å…¨æ„ŸæºäºçœŸå®çš„è¿æ¥ï¼Œè€Œéå®Œç¾ã€‚"
            },
            anxious: {
                badge: 'badge-anxious',
                badgeText: "å¯»æ±‚ç¡®è®¤",
                name: "ç„¦è™‘-çŸ›ç›¾å‹",
                subtitle: "æ¸´æœ›è¿æ¥ï¼Œåˆæ‹…å¿ƒå¤±å»",
                opening: "æˆ‘ä»¬çœ‹åˆ°ï¼Œä½ å¯¹å…³ç³»æœ‰ç€æ·±åˆ»çš„çƒ­æƒ…å’Œæ•é”çš„æ„ŸçŸ¥ã€‚ä½ èƒ½å¤Ÿæ•æ‰åˆ°ç»†å¾®çš„æƒ…æ„Ÿå˜åŒ–ï¼Œè¿™æ˜¯ä¸€ç§éš¾å¾—çš„å¤©èµ‹ã€‚ä½†åŒæ—¶ï¼Œè¿™ç§æ•æ„Ÿä¹Ÿè®©ä½ æ‰¿å—ç€æ›´å¤šçš„ä¸ç¡®å®šæ„Ÿâ€”â€”å®³æ€•ä¸è¢«é‡è§†ï¼Œæ‹…å¿ƒè¢«é—å¿˜ã€‚ä½ å€¼å¾—è¢«ç¨³å®šåœ°çˆ±ç€ï¼Œè€Œä¸éœ€è¦ä¸€ç›´è¯æ˜è‡ªå·±çš„ä»·å€¼ã€‚",
                scenarios: [
                    { situation: "å¯¹æ–¹å‡ å°æ—¶æ²¡å›æ¶ˆæ¯", response: "ä½ çš„å¤§è„‘å¼€å§‹è¿è½¬ï¼š'æ˜¯ä¸æ˜¯æˆ‘è¯´é”™äº†ä»€ä¹ˆï¼Ÿ''ä»–æ˜¯ä¸æ˜¯å¯¹æˆ‘å¤±å»å…´è¶£äº†ï¼Ÿ'ç„¦è™‘æ„Ÿè¿…é€Ÿå‡é«˜" },
                    { situation: "ä¼´ä¾£è¯´éœ€è¦ç©ºé—´", response: "ä½ çš„ç¬¬ä¸€æ„Ÿå—æ˜¯è¢«æ‹’ç»ï¼Œå¾ˆéš¾ç†è§£è¿™ä¸æ˜¯é’ˆå¯¹ä½ ï¼Œè€Œæ˜¯ä»–ä»¬çš„è‡ªæˆ‘ç…§é¡¾æ–¹å¼" },
                    { situation: "å…³ç³»è¿›å±•é¡ºåˆ©æ—¶", response: "ä½ åè€Œä¼šæ‹…å¿ƒ'è¿™ä¼šæŒç»­å¤šä¹…'ï¼Œéš¾ä»¥å®Œå…¨æ²‰æµ¸åœ¨å½“ä¸‹çš„å¹¸ç¦ä¸­" }
                ],
                relationshipImpact: "ä½ çš„é«˜åº¦æ•æ„Ÿè®©ä½ èƒ½å¤Ÿå¯Ÿè§‰ä¼´ä¾£çš„æƒ…ç»ªå˜åŒ–ï¼Œè¿™åœ¨å…³ç³»ä¸­å¾ˆæœ‰ä»·å€¼ã€‚ä½†é¢‘ç¹çš„å¯»æ±‚ç¡®è®¤å¯èƒ½ä¼šè®©å¯¹æ–¹æ„Ÿåˆ°å‹åŠ›ï¼Œæœ‰æ—¶ç”šè‡³æ¨å¼€ä½ æœ€æƒ³ç•™ä½çš„äººã€‚ä½ çš„ç„¦è™‘ä¼ é€’çš„ä¿¡æ¯æ˜¯'æˆ‘éœ€è¦ä½ è¯æ˜ä½ çˆ±æˆ‘'ï¼Œè€Œå¯¹æ–¹å¯èƒ½å¬åˆ°çš„æ˜¯'æˆ‘æ°¸è¿œä¸å¤Ÿ'ã€‚",
                partnerTips: "å¯¹ä½ çš„ä¼´ä¾£ï¼šä»–éœ€è¦çš„ä¸æ˜¯æ— ä¼‘æ­¢çš„ä¿è¯ï¼Œè€Œæ˜¯ä¸€è‡´æ€§ã€‚ä¸å…¶æ¯æ¬¡éƒ½å›åº”ç„¦è™‘ï¼Œä¸å¦‚å»ºç«‹å¯é¢„æœŸçš„è¿æ¥æ¨¡å¼â€”â€”æ¯”å¦‚æ¯å¤©å›ºå®šæ—¶é—´çš„åˆ†äº«ï¼Œè®©ä»–çŸ¥é“è¿æ¥æ˜¯ç¨³å®šçš„ã€‚",
                actions: [
                    { title: "å»ºç«‹è‡ªæˆ‘å®‰æŠšç»ƒä¹ ", desc: "å½“ç„¦è™‘æ¥è¢­æ—¶ï¼Œä½ ä¹ æƒ¯å‘å¤–å¯»æ±‚å®‰æ…°ã€‚ä½†çœŸæ­£çš„ç¨³å®šæ¥è‡ªå†…åœ¨ã€‚", how: "ä¸‹æ¬¡æ„Ÿåˆ°ç„¦è™‘æ—¶ï¼Œå…ˆæŒ‰ä¸‹'æš‚åœé”®'ï¼šæ·±å‘¼å¸5æ¬¡ï¼Œæ‰‹æ”¾åœ¨å¿ƒå£ï¼Œå‘Šè¯‰è‡ªå·±'æˆ‘ç°åœ¨æ˜¯å®‰å…¨çš„'ã€‚ç»™è‡ªå·±20åˆ†é’Ÿå†å†³å®šæ˜¯å¦å‘æ¶ˆæ¯ã€‚" },
                    { title: "è¯†åˆ«ç„¦è™‘æ•…äº‹vsäº‹å®", desc: "ä½ çš„å¤§è„‘æ“…é•¿ç¼–é€ æœ€åçš„æƒ…èŠ‚ã€‚å­¦ä¼šåŒºåˆ†'æˆ‘çš„æ„Ÿå—'å’Œ'å®é™…å‘ç”Ÿçš„äº‹'ã€‚", how: "å‡†å¤‡ä¸€ä¸ªå°æœ¬å­ï¼Œå†™ä¸‹ï¼šæˆ‘æ‹…å¿ƒçš„æ˜¯___ï¼Œå®é™…è¯æ®æ˜¯___ã€‚ä¾‹å¦‚ï¼š'æˆ‘æ‹…å¿ƒä»–ä¸çˆ±æˆ‘äº†'vs'ä»–ä»Šå¤©å›å¤æ¯”è¾ƒæ™š'ã€‚çœ‹çœ‹ä½ çš„æ‹…å¿§æœ‰å¤šå°‘æ˜¯æœ‰ä¾æ®çš„ã€‚" },
                    { title: "åŸ¹å…»å…³ç³»ä¹‹å¤–çš„æ”¯ç‚¹", desc: "å½“å…³ç³»æˆä¸ºä½ å¹¸ç¦æ„Ÿçš„å”¯ä¸€æ¥æºæ—¶ï¼Œç„¦è™‘ä¼šè¢«æ”¾å¤§ã€‚", how: "æ¯å‘¨è‡³å°‘3æ¬¡ï¼Œåšä¸€ä»¶å®Œå…¨å±äºè‡ªå·±çš„äº‹ï¼šå¯èƒ½æ˜¯ç”»ç”»ã€è·‘æ­¥ã€æˆ–å­¦ä¹ æ–°æŠ€èƒ½ã€‚è®©è‡ªå·±çš„ç”Ÿæ´»æœ‰å¤šä¸ª'å¹¸ç¦è´¦æˆ·'ï¼Œè€Œä¸æ˜¯å­¤æ³¨ä¸€æ·ã€‚" }
                ],
                todayAction: "ä»Šå¤©ï¼Œå½“ä½ æƒ³è¦å‘ä¼´ä¾£å¯»æ±‚ç¡®è®¤æ—¶ï¼Œå…ˆç»™è‡ªå·±å†™ä¸€æ¡'è‡ªæˆ‘ç¡®è®¤ä¿¡æ¯'ï¼šåˆ—å‡ºä¸‰ä¸ªä½ åœ¨å…³ç³»ä¸­çš„ä¼˜ç‚¹ï¼Œä¸‰ä¸ªå¯¹æ–¹å–œæ¬¢ä½ çš„ç†ç”±ã€‚ä½ éœ€è¦çš„è®¤å¯ï¼Œé¦–å…ˆæ¥è‡ªä½ è‡ªå·±ã€‚"
            },
            avoidant: {
                badge: 'badge-avoidant',
                badgeText: "ç‹¬ç«‹",
                name: "å›é¿-ç–ç¦»å‹",
                subtitle: "çè§†è‡ªç”±ï¼Œè­¦æƒ•äº²å¯†",
                opening: "æˆ‘ä»¬çœ‹åˆ°ï¼Œä½ æœ‰ç€éå‡¡çš„è‡ªæˆ‘ä¾é èƒ½åŠ›ã€‚ä½ ä¸è½»æ˜“ä¾èµ–ä»–äººï¼Œè¿™è®©ä½ æ˜¾å¾—ç‹¬ç«‹è€Œå¼ºå¤§ã€‚ä½†åœ¨è¿™ä»½ç‹¬ç«‹ä¹‹ä¸‹ï¼Œå¯èƒ½éšè—ç€ä¸€ä¸ªæ—©å¹´çš„å†³å®šï¼š'æˆ‘åªèƒ½é è‡ªå·±'ã€‚ä½ å·²ç»å¾ˆæ“…é•¿ç‹¬å¤„äº†ï¼Œç°åœ¨æˆ–è®¸æ˜¯æ—¶å€™å…è®¸è‡ªå·±ç»ƒä¹ â€”â€”åœ¨ä¸å¤±å»è‡ªæˆ‘çš„å‰æä¸‹ï¼Œè®©ä»–äººèµ°è¿‘ä¸€äº›ã€‚",
                scenarios: [
                    { situation: "å…³ç³»å˜å¾—äº²å¯†æ—¶", response: "ä½ ä¼šä¸è‡ªè§‰åœ°å¯»æ‰¾'å‡ºå£'ï¼šçªç„¶å¾ˆå¿™ã€éœ€è¦ç©ºé—´ã€æˆ–è€…æŒ‘å‰”å¯¹æ–¹çš„å°æ¯›ç—…ï¼Œä¸ºæ‹‰å¼€è·ç¦»æ‰¾ç†ç”±" },
                    { situation: "ä¼´ä¾£è¡¨è¾¾éœ€è¦ä½ æ—¶", response: "ä½ æ„Ÿåˆ°è¢«'ç´¢å–'ï¼Œç”šè‡³æœ‰äº›çª’æ¯ï¼Œä»¿ä½›ä»–ä»¬è¦æŠŠä½ åæ²¡" },
                    { situation: "æœ‰äººçœŸè¯šåœ°å…³å¿ƒä½ ", response: "ä½ çš„ç¬¬ä¸€ååº”å¯èƒ½æ˜¯é˜²å¾¡ï¼š'æˆ‘æ²¡äº‹'ã€'ä¸éœ€è¦'ï¼Œå¾ˆéš¾æ¥å—å¥½æ„" }
                ],
                relationshipImpact: "ä½ å¯¹ç‹¬ç«‹çš„åšæŒï¼Œå¯èƒ½è®©ä¼´ä¾£æ„Ÿè§‰è¢«æ‹’ä¹‹é—¨å¤–ã€‚ä»–ä»¬å¯èƒ½ä¼šè´¨ç–‘ï¼š'ä»–æ˜¯å¦çœŸçš„åœ¨æ„è¿™æ®µå…³ç³»ï¼Ÿ'ä½ çš„ç–ç¦»ä¸æ˜¯å†·æ¼ ï¼Œè€Œæ˜¯ä¸€ç§ä¿æŠ¤æœºåˆ¶â€”â€”ä½†å®ƒä¹Ÿé˜»æŒ¡äº†æ·±åº¦çš„æƒ…æ„Ÿè¿æ¥ã€‚ä½ æ‹‰å¼€çš„è·ç¦»ï¼Œæ°æ°æ˜¯ä½ å†…å¿ƒæ·±å¤„æ¸´æœ›è¢«ç†è§£çš„è·ç¦»ã€‚",
                partnerTips: "å¯¹ä½ çš„ä¼´ä¾£ï¼šä»–éœ€è¦çš„ä¸æ˜¯è¿½é€ï¼Œè€Œæ˜¯å®‰å…¨æ„Ÿã€‚ç»™ä»–å¯æ§çš„äº²å¯†â€”â€”æ¯”å¦‚äº‹å…ˆçº¦å®šå¥½çš„æ·±åº¦å¯¹è¯æ—¶é—´ï¼Œè®©ä»–çŸ¥é“é è¿‘ä½ ä¸ä¼šå¤±å»è‡ªç”±ã€‚",
                actions: [
                    { title: "ç»ƒä¹ å°æ­¥éª¤çš„è„†å¼±", desc: "ä½ ä¸éœ€è¦ä¸€æ¬¡æ€§æ•å¼€å¿ƒæ‰‰ã€‚ä»å°çš„ã€å¯æ§çš„åˆ†äº«å¼€å§‹ã€‚", how: "æœ¬å‘¨é€‰ä¸€å¤©ï¼Œå’Œä¿¡ä»»çš„äººåˆ†äº«ä¸€ä¸ªå°çƒ¦æ¼â€”â€”ä¸éœ€è¦å¾ˆæ·±åˆ»ï¼Œå¯ä»¥æ˜¯'æˆ‘ä»Šå¤©æœ‰ç‚¹ç´¯'ã€‚è§‚å¯Ÿåˆ†äº«åçš„æ„Ÿå—ï¼šä¸–ç•Œæœ‰å› æ­¤å´©å¡Œå—ï¼Ÿ" },
                    { title: "è¯†åˆ«'éœ€è¦ç©ºé—´'vs'é€ƒé¿äº²å¯†'", desc: "ç‹¬å¤„æ˜¯å¥åº·çš„ï¼Œä½†å¦‚æœä½ æ€»æ˜¯åœ¨å…³ç³»æ·±å…¥æ—¶æƒ³è¦é€ƒç¦»ï¼Œé‚£å€¼å¾—æ¢ç´¢ã€‚", how: "ä¸‹æ¬¡æƒ³è¦æ‹‰å¼€è·ç¦»æ—¶ï¼Œé—®è‡ªå·±ï¼šæˆ‘æ˜¯çœŸçš„éœ€è¦ä¼‘æ¯ï¼Œè¿˜æ˜¯åœ¨å®³æ€•ä»€ä¹ˆï¼Ÿå¦‚æœæ˜¯åè€…ï¼Œè¯•ç€ç•™ä¸‹æ¥ï¼Œè®©é‚£ä¸ªä¸é€‚çš„æ„Ÿè§‰å­˜åœ¨5åˆ†é’Ÿã€‚" },
                    { title: "é‡æ–°å®šä¹‰'äº²å¯†'", desc: "äº²å¯†ä¸ç­‰äºå¤±å»è‡ªæˆ‘ã€‚å®ƒå¯ä»¥æ˜¯'æˆ‘ä»¬å„è‡ªå®Œæ•´ï¼ŒåŒæ—¶æ·±åº¦è¿æ¥'ã€‚", how: "å’Œä¼´ä¾£ä¸€èµ·è®¾è®¡'æˆ‘ä»¬çš„äº²å¯†å…¬å¼'ï¼šä»€ä¹ˆæ ·çš„ç›¸å¤„è®©ä½ æ„Ÿåˆ°æ—¢è¿æ¥åˆè‡ªåœ¨ï¼Ÿå¯èƒ½æ˜¯å¹¶è‚©åšäº‹è€Œéé¢å¯¹é¢ï¼Œå¯èƒ½æ˜¯æœ‰é™å®šæ—¶é—´çš„æ·±åº¦å¯¹è¯ã€‚" }
                ],
                todayAction: "ä»Šå¤©ï¼Œä¸»åŠ¨å‘æŸäººè¡¨è¾¾ä¸€ä¸ªå…·ä½“çš„éœ€è¦â€”â€”ä¸æ˜¯'æˆ‘æ²¡äº‹'ï¼Œè€Œæ˜¯'ä½ èƒ½å¸®æˆ‘___å—ï¼Ÿ'è¿™ä¸ä¼šè®©ä½ å˜å¾—è½¯å¼±ï¼Œåè€Œè¯æ˜ä½ æœ‰å‹‡æ°”ä¿¡ä»»ã€‚"
            },
            fearful: {
                badge: 'badge-fearful',
                badgeText: "çŸ›ç›¾",
                name: "ææƒ§-å›é¿å‹",
                subtitle: "æ¸´æœ›åˆå®³æ€•è¢«çœ‹è§",
                opening: "æˆ‘ä»¬çœ‹åˆ°ï¼Œä½ çš„å†…å¿ƒä½ç€ä¸¤è‚¡åŠ›é‡ï¼šä¸€ä¸ªæ¸´æœ›è¢«æ·±æ·±ç†è§£å’Œæ¥çº³ï¼Œå¦ä¸€ä¸ªå®³æ€•å—ä¼¤è€Œæƒ³è¦é€ƒç¦»ã€‚è¿™ç§æ‹‰æ‰¯è®©ä½ åœ¨å…³ç³»ä¸­æ„Ÿåˆ°ç–²æƒ«â€”â€”ä½ æ—¢æƒ³è¦è¿æ¥ï¼Œåˆæœ¬èƒ½åœ°æŠ—æ‹’ã€‚è¿™ä¸æ˜¯ä½ çš„é”™ï¼Œè¿™æ˜¯æ—©å¹´ç»å†æ•™ä¼šä½ çš„ç”Ÿå­˜ç­–ç•¥ã€‚ä½†ç°åœ¨ï¼Œä½ å¯ä»¥å­¦ä¼šä¸€ç§æ–°çš„æ–¹å¼ï¼šåœ¨ä¸å®Œå…¨æ•å¼€ä¹Ÿä¸å®Œå…¨å…³é—­ä¹‹é—´ï¼Œæ‰¾åˆ°å±äºä½ çš„èŠ‚å¥ã€‚",
                scenarios: [
                    { situation: "æœ‰äººè¡¨è¾¾çˆ±æ„æ—¶", response: "ä½ åŒæ—¶æ„Ÿåˆ°æ¸©æš–å’Œææ…Œï¼š'æˆ‘æƒ³è¦è¿™ä»½çˆ±ï¼Œä½†æˆ‘èƒ½ç›¸ä¿¡å—ï¼Ÿå¦‚æœæˆ‘æ¥å—äº†ï¼Œä¼šä¸ä¼šåˆå—ä¼¤ï¼Ÿ'" },
                    { situation: "å…³ç³»ä¸­çš„æ—¥å¸¸", response: "ä½ çš„çŠ¶æ€åƒé’Ÿæ‘†ï¼šæœ‰æ—¶æ¸´æœ›æåº¦äº²å¯†ï¼Œæœ‰æ—¶åˆæƒ³å½»åº•æ¶ˆå¤±ã€‚è¿™ç§æ‘‡æ‘†è®©ä½ å’Œä¼´ä¾£éƒ½æ„Ÿåˆ°å›°æƒ‘" },
                    { situation: "æ„Ÿè§‰è¢«è¯¯è§£æ—¶", response: "ä½ å¯èƒ½ä¼šçªç„¶å…³é—­ï¼Œç”¨å†·æ¼ æˆ–æ„¤æ€’æ¥ä¿æŠ¤è‡ªå·±ï¼Œå³ä½¿ä½ å†…å¿ƒæ¸´æœ›å¯¹æ–¹æ¥ç†è§£ä½ " }
                ],
                relationshipImpact: "ä½ çš„'æ¨æ‹‰'è¡Œä¸ºå¯èƒ½è®©ä¼´ä¾£æ„Ÿåˆ°è¿·å¤±ï¼š'åˆ°åº•æƒ³è¦ä»€ä¹ˆï¼Ÿ'ä½†è¿™ç§çŸ›ç›¾ä¸æ˜¯æ“æ§ï¼Œè€Œæ˜¯ä½ å†…åœ¨å†²çªçš„å¤–æ˜¾ã€‚ä½ åŒæ—¶å‘å‡º'é è¿‘æˆ‘'å’Œ'åˆ«å¤ªè¿‘'çš„ä¿¡å·ï¼Œå› ä¸ºä½ è‡ªå·±ä¹Ÿåœ¨è¿™ä¸¤ç§éœ€æ±‚ä¸­æŒ£æ‰ã€‚",
                partnerTips: "å¯¹ä½ çš„ä¼´ä¾£ï¼šä»–éœ€è¦çš„æ˜¯ç¨³å®šæ€§ï¼Œè€Œä¸æ˜¯æ ¹æ®ä»–çš„ç„¦è™‘æˆ–å›é¿åšååº”ã€‚ä¿æŒæ¸©å’Œè€Œä¸€è‡´çš„å­˜åœ¨ï¼Œåƒä¸€ä¸ªå¯é çš„é”šç‚¹â€”â€”ä¸è¿½é€ï¼Œä¹Ÿä¸æ”¾å¼ƒã€‚",
                actions: [
                    { title: "ä¸ºå†…åœ¨å†²çªå‘½å", desc: "ä½ çš„'æ¨'ä¸'æ‹‰'éƒ½æºäºçœŸå®çš„éœ€æ±‚ã€‚å­¦ä¼šè¯†åˆ«å®ƒä»¬ï¼Œè€Œä¸æ˜¯è¢«å®ƒä»¬æ§åˆ¶ã€‚", how: "ä¸‹æ¬¡æ„Ÿåˆ°å†…åœ¨æŒ£æ‰æ—¶ï¼Œå†™ä¸‹ï¼šç°åœ¨æƒ³è¦é è¿‘çš„'æˆ‘'åœ¨è¯´ä»€ä¹ˆï¼Ÿæƒ³è¦é€ƒç¦»çš„'æˆ‘'åˆåœ¨å®³æ€•ä»€ä¹ˆï¼Ÿç»™ä¸¤ç§å£°éŸ³éƒ½ä¸€äº›ç©ºé—´ã€‚" },
                    { title: "å»ºç«‹'æƒ…ç»ªç¼“å†²åŒº'", desc: "åœ¨å†²åŠ¨ååº”å’Œå…³ç³»è¡Œä¸ºä¹‹é—´ï¼Œåˆ›é€ ä¸€ä¸ªæš‚åœç©ºé—´ã€‚", how: "å½“å¼ºçƒˆæƒ…ç»ªæ¥è¢­æ—¶ï¼ˆæƒ³è¦æ¨å¼€æˆ–é»ä½å¯¹æ–¹ï¼‰ï¼Œç»™è‡ªå·±ä¸€ä¸ª'24å°æ—¶è§„åˆ™'ï¼šç­‰ä¸€å¤©å†é‡‡å–è¡ŒåŠ¨ã€‚è¿™æ®µæ—¶é—´é‡Œï¼Œç”¨æ—¥è®°ã€è¿åŠ¨æˆ–åˆ›ä½œæ¥æ¶ˆåŒ–æƒ…ç»ªã€‚" },
                    { title: "å¯»æ±‚ä¸“ä¸šæ”¯æŒ", desc: "ææƒ§å‹ä¾æ‹å¸¸å¸¸æ ¹æ¤äºæ—©å¹´åˆ›ä¼¤ã€‚æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä¸“ä¸šå¸®åŠ©æ¥è§£å¼€è¿™äº›ç»“ã€‚", how: "è€ƒè™‘æ‰¾ä¸€ä¸ªä¸“æ³¨ä¾æ‹é—®é¢˜çš„å’¨è¯¢å¸ˆã€‚æ²»ç–—ä¸æ˜¯'æœ‰ç—…'ï¼Œè€Œæ˜¯ä½ è®¤çœŸå¯¹å¾…è‡ªå·±å¹¸ç¦çš„ä½“ç°ã€‚" }
                ],
                todayAction: "ä»Šå¤©ï¼Œå½“ä½ æƒ³è¦æ¨å¼€æˆ–è¿‡åº¦é»ä½æŸäººæ—¶ï¼Œè¯•ç€ç›´æ¥è¯´å‡ºä½ çš„çŸ›ç›¾ï¼š'æˆ‘ç°åœ¨å¾ˆæƒ³é€ƒå¼€ï¼ŒåŒæ—¶åˆæƒ³è®©ä½ æŠ±æŠ±æˆ‘ã€‚'è¿™ç§è¯šå®çš„è„†å¼±ï¼Œå¯èƒ½å¼€å¯ä½ ä»æœªä½“éªŒè¿‡çš„è¢«ç†è§£æ„Ÿã€‚"
            }
        };

        let currentQuestion = 0;
        let answers = [];
        let scores = { secure: 0, anxious: 0, avoidant: 0, fearful: 0 };
        let testStartTime = null;
        let loadingProgress = 0;
        let loadingInterval = null;
        const maxPossibleScore = questions.length * 3;

        function showScreen(screenId) {
            const screens = ['welcomeScreen', 'testScreen', 'reflectionScreen', 'resultScreen'];
            screens.forEach(id => {
                const element = document.getElementById(id);
                if (element) element.style.display = 'none';
            });
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                targetScreen.style.display = screenId === 'testScreen' ? 'flex' : 'block';
            }
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function showToast(message, icon = 'âœ“') {
            const toast = document.getElementById('toast');
            document.getElementById('toastMessage').textContent = message;
            document.getElementById('toastIcon').textContent = icon;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        function createConfetti() {
            const colors = ['#ff6b9d', '#c44569', '#ffa502', '#ff6348', '#5f27cd', '#00d2d3'];
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * window.innerWidth + 'px';
                confetti.style.top = '-10px';
                confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 2 + 's';
                document.body.appendChild(confetti);
                setTimeout(() => confetti.remove(), 5000);
            }
        }

        function showModal(title, desc, onConfirm) {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalDesc').textContent = desc;
            document.getElementById('modal').style.display = 'flex';
            document.getElementById('modalConfirm').onclick = () => {
                closeModal();
                onConfirm();
            };
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
        }

        function startLoadingAnimation() {
            loadingProgress = 0;
            const progressBar = document.getElementById('loadingProgressBar');
            const percentageText = document.getElementById('progressPercentage');
            const steps = ['step1', 'step2', 'step3', 'step4'];
            let currentStep = 0;
            document.getElementById(steps[0]).classList.add('active');

            loadingInterval = setInterval(() => {
                loadingProgress += Math.random() * 15 + 5;
                if (loadingProgress >= 100) {
                    loadingProgress = 100;
                    clearInterval(loadingInterval);
                }
                progressBar.style.width = loadingProgress + '%';
                percentageText.textContent = Math.round(loadingProgress) + '%';

                const newStep = Math.min(Math.floor(loadingProgress / 25), steps.length - 1);
                if (newStep > currentStep) {
                    document.getElementById(steps[currentStep]).classList.remove('active');
                    document.getElementById(steps[currentStep]).classList.add('completed');
                    if (newStep < steps.length) {
                        document.getElementById(steps[newStep]).classList.add('active');
                    }
                    currentStep = newStep;
                }
            }, 150);
        }

        function updateBackButton() {
            const backButton = document.getElementById('backButton');
            backButton.disabled = currentQuestion === 0;
            backButton.style.opacity = currentQuestion === 0 ? '0.4' : '1';
        }

        function startTest() {
            currentQuestion = 0;
            answers = [];
            scores = { secure: 0, anxious: 0, avoidant: 0, fearful: 0 };
            testStartTime = Date.now();
            showScreen('testScreen');
            showQuestion();
            updateBackButton();
        }

        function showSettings() {
            showModal('è®¾ç½®', 'è‡ªå®šä¹‰ä½ çš„ä½“éªŒã€‚åŠŸèƒ½å³å°†æ¨å‡ºï¼', () => {});
        }

        function showQuestion() {
            const q = questions[currentQuestion];
            document.getElementById('questionTitle').textContent = q.title;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            q.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                optionDiv.textContent = option.text;
                optionDiv.onclick = () => selectOption(index);
                optionsContainer.appendChild(optionDiv);
            });

            const progress = ((currentQuestion + 1) / questions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            updateBackButton();
        }

        function selectOption(index) {
            const selectedOption = questions[currentQuestion].options[index];
            
            scores.secure += selectedOption.scores.secure;
            scores.anxious += selectedOption.scores.anxious;
            scores.avoidant += selectedOption.scores.avoidant;
            scores.fearful += selectedOption.scores.fearful;

            answers[currentQuestion] = index;

            if (navigator.vibrate) navigator.vibrate(10);

            setTimeout(() => {
                if (currentQuestion < questions.length - 1) {
                    currentQuestion++;
                    showQuestion();
                } else {
                    finishTest();
                }
            }, 300);
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                const prevOption = questions[currentQuestion - 1].options[answers[currentQuestion - 1]];
                if (prevOption) {
                    scores.secure -= prevOption.scores.secure;
                    scores.anxious -= prevOption.scores.anxious;
                    scores.avoidant -= prevOption.scores.avoidant;
                    scores.fearful -= prevOption.scores.fearful;
                }
                currentQuestion--;
                showQuestion();
            }
        }

        function finishTest() {
            showScreen('reflectionScreen');
            startLoadingAnimation();
            setTimeout(() => {
                if (loadingInterval) clearInterval(loadingInterval);
                createConfetti();
                showResults();
            }, 4000);
        }

        function showResults() {
            const percentages = {
                secure: (scores.secure / maxPossibleScore * 100).toFixed(1),
                anxious: (scores.anxious / maxPossibleScore * 100).toFixed(1),
                avoidant: (scores.avoidant / maxPossibleScore * 100).toFixed(1),
                fearful: (scores.fearful / maxPossibleScore * 100).toFixed(1)
            };

            let dominantStyle = Object.entries(percentages).reduce((a, b) => 
                parseFloat(b[1]) > parseFloat(a[1]) ? b : a
            )[0];

            const detail = attachmentDetails[dominantStyle];
            const styleNames = { secure: 'å®‰å…¨å‹', anxious: 'ç„¦è™‘å‹', avoidant: 'å›é¿å‹', fearful: 'ææƒ§å‹' };
            
            let html = `
                <div class="result-opening">
                    <div class="result-opening-icon">ğŸŒ¸</div>
                    <h3 class="result-opening-title">ä½ çš„æµ‹è¯•ç»“æœå·²ç”Ÿæˆ</h3>
                    <p class="result-opening-text">${detail.opening}</p>
                </div>

                <div class="attachment-card">
                    <div class="attachment-badge ${detail.badge}">${detail.badgeText}</div>
                    <h2 class="attachment-name">${detail.name}</h2>
                    <p class="attachment-subtitle">${detail.subtitle}</p>
                    
                    <div class="score-visual">
                        <div class="score-visual-title">ä½ çš„ä¾æ‹æ¡£æ¡ˆç»„æˆ</div>
            `;
            
            for (let style in percentages) {
                const percentage = Math.round(percentages[style]);
                html += `
                    <div class="score-item">
                        <div class="score-label">
                            <span class="score-name">${styleNames[style]}</span>
                            <span class="score-value">${percentage}%</span>
                        </div>
                        <div class="score-bar-bg">
                            <div class="score-bar-fill ${style}" data-width="${percentage}"></div>
                        </div>
                    </div>
                `;
            }
            
            html += `
                    </div>
                </div>

                <div class="scenario-mirror">
                    <div class="scenario-mirror-title">
                        <span>ğŸª</span>
                        <span>åœ¨å…³ç³»ä¸­ï¼Œä½ å¯èƒ½æ˜¯è¿™æ ·çš„</span>
                    </div>
            `;
            
            detail.scenarios.forEach(scenario => {
                html += `
                    <div class="scenario-item">
                        <div class="scenario-situation">${scenario.situation}</div>
                        <div class="scenario-response">${scenario.response}</div>
                    </div>
                `;
            });
            
            html += `
                </div>

                <div class="relationship-impact">
                    <div class="relationship-impact-title">
                        <span>ğŸ’«</span>
                        <span>è¿™å¦‚ä½•å½±å“ä½ çš„å…³ç³»</span>
                    </div>
                    <p class="relationship-impact-text">${detail.relationshipImpact}</p>
                    <div class="partner-tips">
                        <div class="partner-tips-label">
                            <span>ğŸ’¡</span>
                            <span>ç»™ä½ çš„ä¼´ä¾£</span>
                        </div>
                        <p class="partner-tips-text">${detail.partnerTips}</p>
                    </div>
                </div>

                <div class="action-plan">
                    <div class="action-plan-title">
                        <span>ğŸŒ±</span>
                        <span>ä½ çš„æˆé•¿æ–¹æ¡ˆ</span>
                    </div>
                    <div class="action-plan-subtitle">ä¸‰ä¸ªå¯ä»¥ç«‹å³å¼€å§‹çš„æ”¹å˜</div>
            `;
            
            detail.actions.forEach((action, index) => {
                html += `
                    <div class="action-item">
                        <div class="action-number">${index + 1}</div>
                        <div class="action-title">${action.title}</div>
                        <div class="action-desc">${action.desc}</div>
                        <div class="action-how"><strong>å…·ä½“åšæ³•ï¼š</strong>${action.how}</div>
                    </div>
                `;
            });
            
            html += `
                </div>

                <div class="today-action">
                    <div class="today-action-icon">âœ¨</div>
                    <div class="today-action-title">ä»Šå¤©å°±å¼€å§‹</div>
                    <div class="today-action-text">${detail.todayAction}</div>
                    <button class="today-action-button" onclick="showToast('å¾ˆå¥½ï¼è®°ä½è¿™ä¸ªå°è¡ŒåŠ¨ ğŸ’ª', 'ğŸ¯')">æˆ‘ä¼šå°è¯•</button>
                </div>

                <div class="resources-section">
                    <div class="resources-title">
                        <span>ğŸ“š</span>
                        <span>æ·±å…¥å­¦ä¹ </span>
                    </div>
                    <div class="resource-item" onclick="showToast('æ¨èï¼šã€Šä¾æ‹ã€‹by Amir Levine', 'ğŸ“–')">
                        <div class="resource-name">ä¾æ‹ç†è®ºä¹¦ç±</div>
                        <div class="resource-desc">æ·±å…¥ç†è§£ä½ çš„ä¾æ‹æ¨¡å¼</div>
                    </div>
                    <div class="resource-item" onclick="showToast('æ¨èå¯»æ‰¾ç»è¿‡ä¾æ‹è®­ç»ƒçš„å’¨è¯¢å¸ˆ', 'ğŸ’¬')">
                        <div class="resource-name">ä¸“ä¸šå’¨è¯¢æ”¯æŒ</div>
                        <div class="resource-desc">ä¸ä¸“æ³¨ä¾æ‹é—®é¢˜çš„å’¨è¯¢å¸ˆåˆä½œ</div>
                    </div>
                </div>
            `;

            document.getElementById('resultContent').innerHTML = html;
            showScreen('resultScreen');

            setTimeout(() => {
                document.querySelectorAll('.score-bar-fill').forEach(bar => {
                    bar.style.width = bar.dataset.width + '%';
                });
            }, 100);
        }

        function shareResult() {
            showToast('æ„Ÿè°¢åˆ†äº«ä½ çš„æˆé•¿ä¹‹æ—… ğŸ’š', 'âœ¨');
        }

        function restartTest() {
            showModal('é‡æ–°æµ‹è¯•ï¼Ÿ', 'ä½ çš„ç»“æœå°†ä¿å­˜åœ¨å†å²è®°å½•ä¸­ã€‚', () => {
                showToast('å¼€å§‹æ–°çš„æ¢ç´¢...', 'ğŸŒ±');
                setTimeout(() => showScreen('welcomeScreen'), 500);
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => showToast('æ¬¢è¿æ¥åˆ°PsycheFit ğŸŒ±', 'ğŸ‘‹'), 1000);
        });
    </script>
</body>
</html>
